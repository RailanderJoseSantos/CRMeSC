CREATE DATABASE CRMESC
GO
USE CRMESC
GO
CREATE TABLE USUARIOS(
	ID INT IDENTITY,
	USUARIO VARCHAR(30) NOT NULL UNIQUE,
	SENHA VARCHAR(12) NOT NULL,
	CONSTRAINT PKUSUARIOS PRIMARY KEY(ID)
)
GO

INSERT INTO USUARIOS VALUES('RAILANDER','12345')
GO
CREATE TABLE ENDERECO(
	ID INT IDENTITY,
	CEP VARCHAR(11),
	RUA VARCHAR(50),
	BAIRRO VARCHAR(50),
	NUMERO INT,
	CIDADE VARCHAR(50),
	UF VARCHAR(2),
	CONSTRAINT PKENDERECO PRIMARY KEY(ID)
)
GO
CREATE TABLE ALUNO(
	ID INT IDENTITY,
	NOME VARCHAR(50) NOT NULL,
	NASCIMENTO DATETIME NOT NULL,
	GENERO VARCHAR(10) not null,
	TELEFONE VARCHAR(20),
	ENDERECO INT,
	foto image,
	CONSTRAINT FKALUNO_ENDERECO FOREIGN KEY(ENDERECO) REFERENCES ENDERECO(ID),
	CONSTRAINT PKALUNO PRIMARY KEY(ID)
)
GO

/*drop database CRMESC
SELECT  a.nome, * FROM ENDERECO e
inner join aluno a
on e.id = a.id;
*/
select * from endereco
CREATE PROCEDURE PC_INSERE_ENDERECO @cp VARCHAR(11), @ru VARCHAR(50),
@ba VARCHAR(50), @nu INT, @ci VARCHAR(50), @uf VARCHAR(2)
AS
BEGIN
	INSERT INTO ENDERECO(cep, rua, bairro, numero, cidade, uf) VALUES(@cp,@ru,@ba,@nu,@ci,@uf);
END
GO

CREATE PROCEDURE PC_DELETA_ENDERECO @idEnd int
AS
BEGIN
	DELETE FROM ENDERECO WHERE ID = @idEnd;
END
GO
CREATE PROCEDURE PC_DELETA_ULTIMO_ENDERECO
AS
BEGIN
	DELETE FROM ENDERECO WHERE ID = (SELECT MAX(ID) FROM ENDERECO);
END
GO


